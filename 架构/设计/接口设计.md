# 接口设计


### 请求
- 业务层 调用日志客户端
- 日志客户端 把参数，序列号封装成 请求对象，调用网络客户端（http，rmi 等客户端）
- 网络客户端把请求对象，加上远程方法，序列化成请求报文，再与网络服务端所约定的协议（http，rmi） 进行通讯
- 网络服务端收到请求报文后，通过反序列号解析出方法名，参数信息
- 网络服务端调用本地方法，进行日志的存储

### 应答
- 服务端函数把执行结果返回，以结果返回或抛异常形式。
- 网络服务端把返回值，请求序列号封装成应答对象，
- 网络服务端将应答对象进行序列化，发送应答报文
- 网络客户端接收到应答报文，通过反序列化，解析出请求序列号所挂钩的客户端，回调客户端
- 回调客户端

### 异常
#### 通讯异常
- 序列化和反序列化不一致
- 网络通讯异常

#### 业务层异常
- 参数传递不一致
- 系统错误，服务器出问题，数据库，文件写入，网络通讯

#### 出错场景，解决
|出错情况            |解决方案                   |是否重试      |
|:-------------|:-----------------|:---------:|
|通讯框架错误   |抛出框架异常          | 重试           |
|系统错误          | 抛出系统异常         | 重试           |
|业务错误          |返回明确的错误码   | 禁止重试     |

#### 组织代码设计，
##### 以java为例
- 客户端
```
    ResultDO<T>
    异常
```

- 服务端
```
    xxService
    AsynxxService
```

- 服务端核心

- [参考](https://mp.weixin.qq.com/s?__biz=MzAwNjQwNzU2NQ==&mid=402064901&idx=2&sn=0b5f56a97b431ed355b75a9e17f2e754&scene=0&key=710a5d99946419d950011a9fe2ae773c49216c209871d049c4f6b9ed9d7257fb6e5df2b27fad31cf2181c85b50193b47&ascene=0)
