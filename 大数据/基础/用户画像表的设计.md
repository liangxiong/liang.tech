# 用户画像表的设计

- 原因：
- 用户画像的标签特别多，几千上万，如何设计
- 标签字段 有的变更比较频繁

## 两种设计方式：
### 横表 如：
|  用户ID   | 姓名  | 性别 | 年龄 |
|  ----  | ----  | ----|-----|
|  001   | 张三   |  男 |  30 |

- 问题：
  - 随着用户画像的深入， 会有很多细分领域的标签，表结构变动会频繁
  - 不同的标签计算频率不同 如：年龄 1个月算1次，活跃度 1个月算1次。
    - 如果分成不同的小表，有可能导致标签缺失
  - 大量空缺的标签，导致存储稀疏

- 对查询层支持的好

### 竖表 如：
|  用户ID | 标签名  | 标签值 |
|  ----  | ------ | ----- |
|  001   | name   |  张三  |
|  001   | sex    |  男    |
|  001   | age    |  30   |

- 问题：
  - 多维度查询，在竖表中比较麻烦

- 竖表对计算层支持的好

## 横表+竖表  
- 流程：
  - 开发用 竖表  
  - 对外用 宽表
  - 宽表可以做一个收拢

- 如何存储：
  - 标签竖表：存储到Hive（Hdfs）和Hbase
  - 标签宽表：存储到es
